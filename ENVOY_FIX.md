# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å Laravel Envoy

## –ü—Ä–æ–±–ª–µ–º—ã
–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `envoy run deploy` –≤–æ–∑–Ω–∏–∫–∞–ª–∏ —Å–ª–µ–¥—É—é—â–∏–µ –æ—à–∏–±–∫–∏:

1. **–ö–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞**: `zsh: command not found: envoy`
2. **–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è**: `$production` –Ω–µ –±—ã–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
3. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Slack webhook**: URL —Å–æ–¥–µ—Ä–∂–∞–ª placeholder –∑–Ω–∞—á–µ–Ω–∏—è
4. **–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è**: `$commit` –Ω–µ –±—ã–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
5. **SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**: –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É —Å–µ—Ä–≤–µ—Ä—É
6. **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ**: –∑–∞–¥–∞—á–∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –ª–æ–∫–∞–ª—å–Ω–æ
7. **–ü—Ä–æ–±–ª–µ–º—ã —Å npm**: –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–µ—Ä—Å–∏–π –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
8. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**: MySQL –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–µ—Ä–µ

## –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏ –∫ Envoy
–í–º–µ—Å—Ç–æ `envoy run deploy` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
```bash
./vendor/bin/envoy run deploy
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ Envoy.blade.php

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤
```php
// –ë—ã–ª–æ:
@servers(['production' => $production])

// –°—Ç–∞–ª–æ:
@servers(['production' => 'user@your-server.com', 'local' => '127.0.0.1'])
```

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π commit
```php
@setup
    // ... –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    $commit = $commit ?? 'HEAD';
@endsetup
```

#### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ Slack —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```php
// –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã —Å—Ç—Ä–æ–∫–∏ —Å @slack –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –æ—à–∏–±–æ–∫
```

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–¥–∞—á –ø–æ —Å–µ—Ä–≤–µ—Ä–∞–º
```php
// –í—Å–µ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Ç–µ–ø–µ—Ä—å –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ production —Å–µ—Ä–≤–µ—Ä–µ
@task('clone_repository', ['on' => 'production'])
@task('run_composer', ['on' => 'production'])
@task('update_symlinks', ['on' => 'production'])
@task('optimize_application', ['on' => 'production'])
@task('migrate_database', ['on' => 'production'])
@task('restart_services', ['on' => 'production'])
@task('rollback', ['on' => 'production'])
@task('cleanup', ['on' => 'production'])
```

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ npm –∫–æ–º–∞–Ω–¥
```php
// –ò–∑–º–µ–Ω–µ–Ω–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ —Å–±–æ—Ä–∫–∏
npm install          // –≤–º–µ—Å—Ç–æ npm ci --production
npm run build
npm prune --production  // —É–¥–∞–ª–µ–Ω–∏–µ dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏
```

### 3. –õ–æ–∫–∞–ª—å–Ω—ã–π –¥–µ–ø–ª–æ–π
–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è story –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:
```bash
./vendor/bin/envoy run deploy-local
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç:
- –£—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Composer
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏ —à–∞–±–ª–æ–Ω–æ–≤
- –°–±–æ—Ä–∫—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
```bash
./vendor/bin/envoy run deploy-local
```

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (–ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞):
```bash
./vendor/bin/envoy run deploy
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
- –ö–æ–º–∞–Ω–¥–∞ envoy —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ `./vendor/bin/envoy`
- –ó–∞–¥–∞—á–∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ
- –õ–æ–∫–∞–ª—å–Ω—ã–π –¥–µ–ø–ª–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –°–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–µ—Ä–µ
- –í—Å–µ –∑–∞–¥–∞—á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –ø–æ —Å–µ—Ä–≤–µ—Ä–∞–º

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è:
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ**: MySQL —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (Connection refused)
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ `.env` –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–µ—Ä–µ
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ MySQL —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω

### üìä –°—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è:
- ‚úÖ –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Composer –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π  
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Laravel
- ‚úÖ –°–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (Vite)
- ‚ùå –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π (–ø—Ä–æ–±–ª–µ–º–∞ —Å –ë–î)
- ‚ùå –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ (–Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ –ë–î)